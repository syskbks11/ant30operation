! Must have X terminal
! Must have VAX binary file scan_0043.dat, copy it from /star/bin/specx
! Must have VAX binary file l483core.dat,  copy it from /star/bin/specx
! Must have VAX binary file l483cmap.map,  copy it from /star/bin/specx

SET-DUMP Y
SET-QUADRANT-DISPLAY 1 1 1 1 1 1 1 1
SET-X-SCALE 3\N
SET-VEL-FRAME Y\GEO\RAD\0
S-P-SC Y Y
SET-PLOT-PARAMETERS Y\Y\3
SET-TERMINAL-DEVICE xw \
SET-HARDCOPY-DEVICE ps_l
SET-PLOT-DEVICE T
SET-INTERACTIVE N

SET-GSD-FILENAME obs_das_
INDEX-GSD-FILES 11
READ-GSD-DATA 11\\0 0
das-merge \\\\
XY-INTERCHANGE
SHOW-X-SCALE
EXTRACT-QUADRANT 2
NEW-PLOT 1 3

$rm l483core.sdf
CONVERT-VAX-FILE l483core.dat
OPEN-FILE l483core
READ-SPECTRUM 1 15
SHOW-STACK

SHOW-X-SCALE
LINE_WEIGHT=1
HISTOGRAM=T
REMOVE-LINEAR-BASELINE\-20 0\25 39
STORE-SPECTRUM 1
NEW-PLOT 1 2
FIT_TOL=0.05
MAX_ITS=20
FIT_DEBUG=-1
FIT-GAUSSIAN-MODEL\0,25\^d\5 4 16\^Z
HISTOGRAM=F
OVERLAY-SPECTRUM 1 3
SUBTRACT-SPECTRA
OFFSET-SPECTRUM -1.5
HISTOGRAM=T
OVERLAY-SPECTRUM 1 4

S-P-D H
REC-SPEC 1
LINE_WEIGHT=2
NEW-PLOT 2 3
SET-INTER N
FIT-G-MODEL \\^Z\4 2 12\6 3 16\^Z
HISTOGRAM=F
OV-S 2 4
CALC-G-MODEL 1\^Z
OV-S 2 5
CALC-G-MODEL 2\^Z
OV-S 2 6
SEE-PLOT T
CLOSE-PLOT

S-P-D T
S-INT N
$rm l483core_map.sdf

OPEN-MAP-FILE l483core\y\L483core\starlink\\10 10\0.0\17 9\65
DO I 1 72
   READ-SPECTRUM 1 I
   ADD-TO-MAP
ENDDO
LIST-MAP N
SET-MAP-SCALES R D\80 -80\-50 50
SET-MAP-PARAM Y\Y\Y\2 2\Y\19\0 1 2
LINE_WEIGHT=1
CONTOUR-MAP 0 40\N
LINE_WEIGHT=2
SET-GREYSCALE Y\Y\4
GREYSCALE-MAP 0 40\N
GET-SPEC-F-MAP \0 0
HISTOGRAM=T
LINE_WEIGHT=1
SCAN_TITLE='Another test'
NEW-PLOT 1 4
LINE_WEIGHT=1
GRID-SPECTRA 0 20\-2 6\N
CLOSE-MAP

$rm l483cmap_map.sdf
CONVERT-VAX-MAP l483cmap
OPEN-MAP-FILE l483cmap
CONTOUR-MAP 0 40\N
CLOSE-MAP
